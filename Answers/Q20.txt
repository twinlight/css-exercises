

CREATE TABLE Employee (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(50),
    Position VARCHAR(50),
    salary DECIMAL(10, 2),
    dept_id INT
);

CREATE TABLE Department (
    dept_id INT PRIMARY KEY,
    dept_name VARCHAR(50),
    HOD VARCHAR(50)
);


INSERT INTO Employee (emp_id, emp_name, Position, salary, dept_id) VALUES
(1, 'Anish', 'Manager', 25000, 1),
(2, 'Sita', 'Secretary', 25000, 2),
(3, 'Ronit', 'Analyst', 40000, 5),
(4, 'Riya', 'Manager', 50000, 3);


INSERT INTO Department (dept_id, dept_name, HOD) VALUES
(1, 'Sales', 'Janak'),
(2, 'Marketing', 'Madhav'),
(3, 'Finance', 'Sapana'),
(4, 'Operations', 'Durga');



i.)

SELECT e.emp_name, e.Position, e.salary
FROM Employee e
JOIN Department d ON e.dept_id = d.dept_id
WHERE d.dept_name = 'Finance';


ii.)

SELECT e.emp_name
FROM Employee e
JOIN Department d ON e.dept_id = d.dept_id
WHERE d.dept_name = 'Sales';


iii.)

SELECT AVG(salary) AS average_salary
FROM Employee;


iv.)

SELECT emp_name, salary
FROM Employee
ORDER BY salary ASC
LIMIT 1;



v.)

-- First, find the average salary
SET @avg_salary = (SELECT AVG(salary) FROM Employee);

-- Then, delete employees whose salary is less than the average salary
DELETE FROM Employee
WHERE salary < @avg_salary;


vi.)

SELECT d.HOD
FROM Employee e
JOIN Department d ON e.dept_id = d.dept_id
WHERE e.emp_name = 'Riya';

